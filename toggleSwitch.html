<!DOCTYPE html>
<html>

<head>
    <title>Toggle switch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
</head>

<body>
    <div class="card">
        <div class="button expansionButton" style="text-align: right">
            <a href="javascript:void(0)">[+]</a></div>
        <div class="button truncationButton" style="text-align: right"><a href="javascript:void(0)">[-]</a></div>
        <div class="cardBody truncatedBody">Subtracted stuff!</div>
        <div class="cardBody expandedBody">
            Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff!
        </div>
    </div>
    <hr>
    <div class="card">
        <div class="cardBody truncatedBody">Truncated stuff
            <div class="button expansionButton">[See more]</div>
        </div>
        <div class="cardBody expandedBody" id="anExpanded">
            Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff! Expanded stuff!
            <div class="button truncationButton">[See less]</div>
        </div>
    </div>
    <script type="text/javascript">
    function DisplayToggle(params) {

        this.checkParams = function(params) {
            foo = params;
            if (!params.hasOwnProperty('$element1'))
                throw new Error('no $element1');
            if (!params.hasOwnProperty('$element2'))
                throw new Error('no $element2');
        }

        this.checkParams(params);
        this.$element1 = params.$element1;
        this.$element2 = params.$element2;

        this.toElement1 = function() {
            this.$element1.show();
            this.$element2.hide();
        }

        this.toElement2 = function() {
            this.$element2.show();
            this.$element1.hide();
        }
    }

    function CompositeDisplayToggle(displayToggles) {

        this.displayToggles = displayToggles;

        this.allToElement1 = function() {
            for (let displayToggle of this.displayToggles) {
                displayToggle.toElement1();
            }
        }

        this.allToElement2 = function() {
            for (let displayToggle of this.displayToggles) {
                displayToggle.toElement2();
            }
        }
    }
    </script>
    <script type="text/javascript">
    var getCardElements = function($element) {
        var $parent = $element.parent(".card");
        if ($parent.length != 1) {
            throw new Error("Should only have one card parent!");
        }
        return {
            $truncationButton: $parent.find(".truncationButton"),
            $expansionButton: $parent.find(".expansionButton"),
            $truncatedBody: $parent.find(".truncatedBody"),
            $expandedBody: $parent.find(".expandedBody"),
        }
    }

    function wireUpCard(params) {
        function checkParams(params) {
            requiredAttributes = [
                '$truncationButton',
                '$expansionButton',
                '$truncatedBody',
                '$expandedBody',
            ];
            for (let attr of requiredAttributes) {
                if (!params.hasOwnProperty(attr)) {
                    throw new Error("doesn't have  " + attr);
                }
            }
        }
        checkParams(params);

        var buttonParams = {
            $element1: params.$expansionButton,
            $element2: params.$truncationButton,
        }

        var bodyParams = {
            $element1: params.$truncatedBody,
            $element2: params.$expandedBody,
        }

        var card = new CompositeDisplayToggle([
            new DisplayToggle(buttonParams),
            new DisplayToggle(bodyParams)
        ]);

        params.$expansionButton.click(function() {
            card.allToElement2()
        });
        params.$truncationButton.click(function() {
            card.allToElement1()
        });

        return card;
    }

    var foo = $("#anExpanded");
    wireUpCard(getCardElements(foo));
    </script>
</body>

</html>
